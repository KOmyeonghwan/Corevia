<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="_csrf" content="{{_csrf.token}}">
    <meta name="_csrf_header" content="{{_csrf.headerName}}">
    <link rel="stylesheet" href="/admin/sidebar.css">
    <link rel="stylesheet" href="/admin/adboardwrite.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <title>관리자 - 게시판 글쓰기 페이지</title>

</head>

<body>
    <div class="wrapper">
        {{> fragments/sidebar}}

        <form class="main-content" method="POST" action="/userboard/post" enctype="multipart/form-data"
            onsubmit="return syncEditor()">
            <input type="hidden" name="{{_csrf.parameterName}}" value="{{_csrf.token}}">

            <h2>게시판 글쓰기</h2>

            <!-- 말머리 & 프로젝트 선택 -->
            <div class="form-row">
                <label for="category">게시판 선택</label>
                <select id="category" name="boardCode" required>
                    {{#boards}}
                    <option value="{{boardCode}}">{{boardName}}</option>
                    {{/boards}}
                </select>

                <!-- 제목 입력 -->
                <input type="text" placeholder="제목을 입력하세요" class="title-input" name="title">
            </div>

            <div class="attachment-box">
                <label for="fileUpload">첨부파일</label>
                <input type="file" id="fileUpload" name="boardFile"> <!-- multiple -->
            </div>

            <div class="editor">
                <!-- 에디터 상단 툴바 -->
                <div class="editor-toolbar">
                    <button disabled><i class="fa-solid fa-bold"></i></button>
                    <button disabled><i class="fa-solid fa-italic"></i></button>
                    <button disabled><i class="fa-solid fa-underline"></i></button>
                    <button disabled><i class="fa-solid fa-align-left"></i></button>
                    <button disabled><i class="fa-solid fa-align-center"></i></button>
                    <button disabled><i class="fa-solid fa-align-right"></i></button>
                    <button disabled><i class="fa-solid fa-list-ul"></i></button>
                    <button disabled><i class="fa-solid fa-list-ol"></i></button>
                </div>

                <!-- 에디터 본문 (지금은 div로 디자인만) -->
                <div id="editor-content" class="editor-content" contenteditable="true">

                </div>

            </div>

            <!-- 전송용 -->
            <input type="hidden" name="content" id="content">

            <input type="hidden" name="id" value="{{loginUser.userPk}}">
            <input type="hidden" name="userName" value="{{loginUser.userName}}">
            <input type="hidden" name="deptCode" value="{{loginUser.department_id}}">
            <input type="hidden" name="positionLevel" value="{{loginUser.positionLevel}}">

            <!-- 버튼 -->
            <div class="form-actions">
                <button class="btn-cancel" type="submit" onclick="location.href='/adboard'">취소</button>
                <button class="btn-submit">등록</button>
            </div>
        </form>

    </div>

    <script>
        const csrfToken = document.querySelector('meta[name="_csrf"]').content;
        const csrfHeader = document.querySelector('meta[name="_csrf_header"]').content;
        
        function syncEditor() {
            const editor = document.getElementById('editor-content');
            const hidden = document.getElementById('content');

            if (editor.innerText.trim() === '') {
                return false;
            }

            hidden.value = editor.innerHTML.trim();
            return true;
        }
    </script>

</body>

</html>